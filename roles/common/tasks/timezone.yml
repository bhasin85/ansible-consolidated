

    # Debian documentation indicates /etc/localtime cannot be a symbolic link.
    # Since ansible file doesn't support copying local files, we must use command/shell
    # this means manually computing whether we need to modify
    # https://wiki.debian.org/TimeZoneChanges

  - shell: cat /etc/localtime | md5sum 
    register: current

  - shell: cat /usr/share/zoneinfo/{{ timezone }} | md5sum
    register: expected

  - command: cp -f /usr/share/zoneinfo/{{ timezone }} /etc/localtime
    when:  current.stdout != expected.stdout 
    notify: reconfigure-tzdata

  - template: src=timezone.j2 dest=/etc/timezone force=yes mode=0644
    notify: reconfigure-tzdata

